<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Cuadre de Caja Pro</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <i class="fas fa-cash-register"></i>
            </div>
            <div class="loading-text">Cargando Sistema...</div>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <div class="login-logo">
                    <i class="fas fa-cash-register"></i>
                </div>
                <h1>Sistema de Cuadre de Caja</h1>
                <p>Gesti√≥n profesional de caja</p>
            </div>
            
            <div class="login-form">
                <div class="input-group">
                    <i class="fas fa-envelope"></i>
                    <input type="email" id="loginEmail" placeholder="Correo electr√≥nico" autocomplete="email">
                </div>
                
                <div class="input-group">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="loginPassword" placeholder="Contrase√±a" autocomplete="current-password">
                </div>
                
                <button id="loginBtn" class="btn-primary">
                    <i class="fas fa-sign-in-alt"></i>
                    Iniciar Sesi√≥n
                </button>
                
                <div class="login-divider">
                    <span>o</span>
                </div>
                
                <button id="registerBtn" class="btn-secondary">
                    <i class="fas fa-user-plus"></i>
                    Crear Cuenta
                </button>
                
                <div id="authError" class="auth-error" style="display: none;"></div>
            </div>
            
            <div class="login-footer">
                <p>Demo: admin@demo.com / admin123</p>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="main-app" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <div class="logo">
                    <i class="fas fa-cash-register"></i>
                    <span>Cuadre de Caja Pro</span>
                </div>
            </div>
            
            <div class="header-right">
                <div class="user-info">
                    <div class="user-details">
                        <span class="user-name" id="userName">Usuario</span>
                        <span class="user-role" id="userRole">Admin</span>
                    </div>
                    <div class="user-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                </div>
                <button id="themeToggle" class="icon-btn" title="Cambiar tema">
                    <i class="fas fa-moon"></i>
                </button>
                <button id="logoutBtn" class="icon-btn" title="Cerrar sesi√≥n">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </header>

        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="nav-date">
                <i class="fas fa-calendar-day"></i>
                <span id="currentDate"></span>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item active" data-tab="movimientos">
                    <i class="fas fa-exchange-alt"></i>
                    <span>Movimientos</span>
                </li>
                <li class="nav-item" data-tab="cuadre">
                    <i class="fas fa-calculator"></i>
                    <span>Cuadre de Caja</span>
                </li>
                <li class="nav-item" data-tab="reportes">
                    <i class="fas fa-file-alt"></i>
                    <span>Reportes</span>
                </li>
                <li class="nav-item" data-tab="graficos">
                    <i class="fas fa-chart-line"></i>
                    <span>Gr√°ficos</span>
                </li>
                <li class="nav-item" data-tab="configuracion">
                    <i class="fas fa-cog"></i>
                    <span>Configuraci√≥n</span>
                </li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Tab: Movimientos -->
            <div id="tab-movimientos" class="tab-content active">
                <div class="tab-header">
                    <h2><i class="fas fa-exchange-alt"></i> Registrar Movimientos</h2>
                </div>
                
                <div class="content-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Nuevo Movimiento</h3>
                        </div>
                        <div class="card-body">
                            <form id="movimientoForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Tipo de Movimiento</label>
                                        <select id="tipoMovimiento" required>
                                            <option value="ingreso">üí∞ Ingreso</option>
                                            <option value="egreso">üí∏ Egreso</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Monto ($)</label>
                                        <input type="number" id="monto" step="0.01" min="0" required placeholder="0.00">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>Categor√≠a</label>
                                    <select id="categoria" required>
                                        <!-- Se llenar√° din√°micamente -->
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>Descripci√≥n</label>
                                    <textarea id="descripcion" rows="3" placeholder="Detalles del movimiento..."></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label>Forma de Pago</label>
                                    <select id="formaPago" required>
                                        <option value="efectivo">üíµ Efectivo</option>
                                        <option value="tarjeta">üí≥ Tarjeta</option>
                                        <option value="transferencia">üè¶ Transferencia</option>
                                        <option value="cheque">üìù Cheque</option>
                                    </select>
                                </div>
                                
                                <button type="submit" class="btn-primary btn-block">
                                    <i class="fas fa-save"></i>
                                    Registrar Movimiento
                                </button>
                            </form>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Resumen del D√≠a</h3>
                        </div>
                        <div class="card-body">
                            <div class="summary-stats">
                                <div class="stat-card stat-ingreso">
                                    <div class="stat-icon">
                                        <i class="fas fa-arrow-up"></i>
                                    </div>
                                    <div class="stat-details">
                                        <span class="stat-label">Ingresos</span>
                                        <span class="stat-value" id="totalIngresos">$0.00</span>
                                    </div>
                                </div>
                                
                                <div class="stat-card stat-egreso">
                                    <div class="stat-icon">
                                        <i class="fas fa-arrow-down"></i>
                                    </div>
                                    <div class="stat-details">
                                        <span class="stat-label">Egresos</span>
                                        <span class="stat-value" id="totalEgresos">$0.00</span>
                                    </div>
                                </div>
                                
                                <div class="stat-card stat-balance">
                                    <div class="stat-icon">
                                        <i class="fas fa-balance-scale"></i>
                                    </div>
                                    <div class="stat-details">
                                        <span class="stat-label">Balance</span>
                                        <span class="stat-value" id="balance">$0.00</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Movimientos de Hoy</h3>
                        <div class="card-actions">
                            <input type="text" id="searchMovimientos" placeholder="Buscar..." class="search-input">
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table id="movimientosTable">
                                <thead>
                                    <tr>
                                        <th>Hora</th>
                                        <th>Tipo</th>
                                        <th>Categor√≠a</th>
                                        <th>Descripci√≥n</th>
                                        <th>Forma Pago</th>
                                        <th>Monto</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="movimientosTableBody">
                                    <tr class="empty-row">
                                        <td colspan="7">No hay movimientos registrados hoy</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab: Cuadre de Caja -->
            <div id="tab-cuadre" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-calculator"></i> Cuadre de Caja</h2>
                </div>
                
                <div class="content-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Fondo Inicial</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label>Fondo de Apertura ($)</label>
                                <input type="number" id="fondoInicial" step="0.01" min="0" placeholder="0.00">
                            </div>
                            <button id="guardarFondoBtn" class="btn-primary btn-block">
                                <i class="fas fa-save"></i>
                                Guardar Fondo Inicial
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Resumen de Caja</h3>
                        </div>
                        <div class="card-body">
                            <div class="cuadre-summary">
                                <div class="cuadre-item">
                                    <span>Fondo Inicial:</span>
                                    <span id="cuadreFondoInicial">$0.00</span>
                                </div>
                                <div class="cuadre-item">
                                    <span>Total Ingresos:</span>
                                    <span id="cuadreIngresos">$0.00</span>
                                </div>
                                <div class="cuadre-item">
                                    <span>Total Egresos:</span>
                                    <span id="cuadreEgresos">$0.00</span>
                                </div>
                                <div class="cuadre-divider"></div>
                                <div class="cuadre-item cuadre-total">
                                    <span>Saldo Esperado:</span>
                                    <span id="saldoEsperado">$0.00</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Efectivo en Caja (Conteo F√≠sico)</h3>
                    </div>
                    <div class="card-body">
                        <div class="denominaciones-grid">
                            <!-- Billetes -->
                            <div class="denominacion-group">
                                <h4>Billetes</h4>
                                <div class="denominacion-item" data-valor="100">
                                    <span class="denom-label">$100</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="50">
                                    <span class="denom-label">$50</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="20">
                                    <span class="denom-label">$20</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="10">
                                    <span class="denom-label">$10</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="5">
                                    <span class="denom-label">$5</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="1">
                                    <span class="denom-label">$1</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                            </div>
                            
                            <!-- Monedas -->
                            <div class="denominacion-group">
                                <h4>Monedas</h4>
                                <div class="denominacion-item" data-valor="0.50">
                                    <span class="denom-label">$0.50</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="0.25">
                                    <span class="denom-label">$0.25</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="0.10">
                                    <span class="denom-label">$0.10</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="0.05">
                                    <span class="denom-label">$0.05</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="0.01">
                                    <span class="denom-label">$0.01</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="cuadre-resultado">
                            <div class="resultado-item">
                                <span>Total Contado:</span>
                                <span id="totalContado" class="resultado-valor">$0.00</span>
                            </div>
                            <div class="resultado-item">
                                <span>Diferencia:</span>
                                <span id="diferencia" class="resultado-valor">$0.00</span>
                            </div>
                        </div>
                        
                        <button id="guardarCuadreBtn" class="btn-primary btn-block">
                            <i class="fas fa-check-circle"></i>
                            Guardar Cuadre
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tab: Reportes -->
            <div id="tab-reportes" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-file-alt"></i> Reportes</h2>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Filtros de Reporte</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Fecha Desde</label>
                                <input type="date" id="fechaDesde">
                            </div>
                            <div class="form-group">
                                <label>Fecha Hasta</label>
                                <input type="date" id="fechaHasta">
                            </div>
                            <div class="form-group">
                                <label>Tipo</label>
                                <select id="filtroTipo">
                                    <option value="">Todos</option>
                                    <option value="ingreso">Ingresos</option>
                                    <option value="egreso">Egresos</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <button id="generarReporteBtn" class="btn-primary">
                                    <i class="fas fa-sync-alt"></i>
                                    Generar Reporte
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="content-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Resumen del Per√≠odo</h3>
                        </div>
                        <div class="card-body">
                            <div class="summary-stats">
                                <div class="stat-card stat-ingreso">
                                    <div class="stat-icon">
                                        <i class="fas fa-arrow-up"></i>
                                    </div>
                                    <div class="stat-details">
                                        <span class="stat-label">Total Ingresos</span>
                                        <span class="stat-value" id="reporteIngresos">$0.00</span>
                                    </div>
                                </div>
                                
                                <div class="stat-card stat-egreso">
                                    <div class="stat-icon">
                                        <i class="fas fa-arrow-down"></i>
                                    </div>
                                    <div class="stat-details">
                                        <span class="stat-label">Total Egresos</span>
                                        <span class="stat-value" id="reporteEgresos">$0.00</span>
                                    </div>
                                </div>
                                
                                <div class="stat-card stat-balance">
                                    <div class="stat-icon">
                                        <i class="fas fa-chart-line"></i>
                                    </div>
                                    <div class="stat-details">
                                        <span class="stat-label">Balance Neto</span>
                                        <span class="stat-value" id="reporteBalance">$0.00</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Por Categor√≠a</h3>
                        </div>
                        <div class="card-body">
                            <canvas id="reporteCategoriaChart" height="200"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Detalle de Movimientos</h3>
                        <button id="exportarExcelBtn" class="btn-secondary">
                            <i class="fas fa-file-excel"></i>
                            Exportar Excel
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Tipo</th>
                                        <th>Categor√≠a</th>
                                        <th>Descripci√≥n</th>
                                        <th>Monto</th>
                                    </tr>
                                </thead>
                                <tbody id="reporteTableBody">
                                    <tr class="empty-row">
                                        <td colspan="5">Seleccione un rango de fechas y genere el reporte</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab: Gr√°ficos -->
            <div id="tab-graficos" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-chart-line"></i> Gr√°ficos y Estad√≠sticas</h2>
                </div>
                
                <div class="content-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Ingresos vs Egresos (√öltimos 7 D√≠as)</h3>
                        </div>
                        <div class="card-body">
                            <canvas id="ingresosEgresosChart" height="250"></canvas>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Distribuci√≥n por Categor√≠a</h3>
                        </div>
                        <div class="card-body">
                            <canvas id="categoriasPieChart" height="250"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="content-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Formas de Pago (Hoy)</h3>
                        </div>
                        <div class="card-body">
                            <canvas id="formasPagoChart" height="250"></canvas>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Tendencia Mensual</h3>
                        </div>
                        <div class="card-body">
                            <canvas id="tendenciaMensualChart" height="250"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab: Configuraci√≥n -->
            <div id="tab-configuracion" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-cog"></i> Configuraci√≥n</h2>
                </div>
                
                <div class="content-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Categor√≠as de Ingresos</h3>
                        </div>
                        <div class="card-body">
                            <div id="categoriasIngresoList" class="categorias-list"></div>
                            <div class="form-group">
                                <input type="text" id="nuevaCategoriaIngreso" placeholder="Nueva categor√≠a...">
                                <button id="addCategoriaIngresoBtn" class="btn-primary">
                                    <i class="fas fa-plus"></i>
                                    Agregar
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Categor√≠as de Egresos</h3>
                        </div>
                        <div class="card-body">
                            <div id="categoriasEgresoList" class="categorias-list"></div>
                            <div class="form-group">
                                <input type="text" id="nuevaCategoriaEgreso" placeholder="Nueva categor√≠a...">
                                <button id="addCategoriaEgresoBtn" class="btn-primary">
                                    <i class="fas fa-plus"></i>
                                    Agregar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Preferencias Generales</h3>
                    </div>
                    <div class="card-body">
                        <div class="settings-group">
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label>Moneda</label>
                                    <small>Selecciona la moneda de tu sistema</small>
                                </div>
                                <select id="monedaSelect">
                                    <option value="USD">USD ($)</option>
                                    <option value="EUR">EUR (‚Ç¨)</option>
                                    <option value="MXN">MXN ($)</option>
                                    <option value="COP">COP ($)</option>
                                </select>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label>Modo Oscuro</label>
                                    <small>Activar tema oscuro</small>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="darkModeSwitch">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label>Respaldo Autom√°tico</label>
                                    <small>Crear respaldo diario de datos</small>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="autoBackupSwitch" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <button id="resetDataBtn" class="btn-danger">
                            <i class="fas fa-trash-alt"></i>
                            Limpiar Todos los Datos
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Modal Confirm -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <h3 id="confirmTitle">Confirmar Acci√≥n</h3>
            <p id="confirmMessage">¬øEst√° seguro?</p>
            <div class="modal-actions">
                <button id="confirmCancelBtn" class="btn-secondary">Cancelar</button>
                <button id="confirmOkBtn" class="btn-primary">Confirmar</button>
            </div>
        </div>
    </div>

    <script src="firebase-config.js"></script>
    <script src="app.js"></script>
</body>
</html>
