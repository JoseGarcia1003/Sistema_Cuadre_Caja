<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Cuadre de Caja Pro</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Loading -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo"><i class="fas fa-cash-register"></i></div>
            <div class="loading-text">Cargando Sistema...</div>
            <div class="loading-bar"><div class="loading-progress"></div></div>
        </div>
    </div>

    <!-- Login -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <div class="login-logo"><i class="fas fa-cash-register"></i></div>
                <h1>Sistema de Cuadre de Caja</h1>
                <p>Gesti칩n profesional de caja</p>
            </div>
            
            <div class="login-form">
                <div class="input-group">
                    <i class="fas fa-envelope"></i>
                    <input type="email" id="loginEmail" placeholder="Correo electr칩nico">
                </div>
                
                <div class="input-group">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="loginPassword" placeholder="Contrase침a">
                </div>
                
                <button id="loginBtn" class="btn-primary">
                    <i class="fas fa-sign-in-alt"></i> Iniciar Sesi칩n
                </button>
                
                <div class="login-divider"><span>o</span></div>
                
                <button id="registerBtn" class="btn-secondary">
                    <i class="fas fa-user-plus"></i> Crear Cuenta
                </button>
                
                <div id="authError" class="auth-error" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="main-app" style="display: none;">
        <header class="app-header">
            <div class="header-left">
                <div class="logo">
                    <i class="fas fa-cash-register"></i>
                    <span>Cuadre de Caja Pro</span>
                </div>
            </div>
            
            <div class="header-right">
                <div class="user-info">
                    <div class="user-details">
                        <span class="user-name" id="userName">Usuario</span>
                        <span class="user-role" id="userRole">Admin</span>
                    </div>
                    <div class="user-avatar"><i class="fas fa-user-circle"></i></div>
                </div>
                <button id="themeToggle" class="icon-btn"><i class="fas fa-moon"></i></button>
                <button id="logoutBtn" class="icon-btn"><i class="fas fa-sign-out-alt"></i></button>
            </div>
        </header>

        <nav class="sidebar">
            <div class="nav-date">
                <i class="fas fa-calendar-day"></i>
                <span id="currentDate"></span>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item active" data-tab="movimientos">
                    <i class="fas fa-exchange-alt"></i><span>Movimientos</span>
                </li>
                <li class="nav-item" data-tab="cuadre">
                    <i class="fas fa-calculator"></i><span>Cuadre de Caja</span>
                </li>
                <li class="nav-item" data-tab="reportes">
                    <i class="fas fa-file-alt"></i><span>Reportes</span>
                </li>
                <li class="nav-item" data-tab="graficos">
                    <i class="fas fa-chart-line"></i><span>Gr치ficos</span>
                </li>
                <li class="nav-item" data-tab="configuracion">
                    <i class="fas fa-cog"></i><span>Configuraci칩n</span>
                </li>
            </ul>
        </nav>

        <main class="main-content">
            <!-- MOVIMIENTOS -->
            <div id="tab-movimientos" class="tab-content active">
                <div class="tab-header">
                    <h2><i class="fas fa-exchange-alt"></i> Registrar Movimientos</h2>
                </div>
                
                <div class="content-grid-full">
                    <div class="card">
                        <div class="card-header"><h3>Nuevo Movimiento</h3></div>
                        <div class="card-body">
                            <form id="movimientoForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Tipo de Movimiento</label>
                                        <select id="tipoMovimiento" required>
                                            <option value="ingreso">游눯 Ingreso (dinero que entra)</option>
                                            <option value="gasto">游눶 Gasto (salida operativa)</option>
                                            <option value="deposito">游낁 Dep칩sito (dinero al banco)</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Monto ($)</label>
                                        <input type="number" id="monto" step="0.01" min="0" required placeholder="0.00">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>Categor칤a</label>
                                    <select id="categoria" required></select>
                                </div>
                                
                                <div class="form-group">
                                    <label>Descripci칩n</label>
                                    <textarea id="descripcion" rows="2" placeholder="Detalles del movimiento..."></textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label>Forma de Pago</label>
                                    <select id="formaPago" required>
                                        <option value="efectivo">游눳 Efectivo</option>
                                        <option value="tarjeta">游눱 Tarjeta</option>
                                        <option value="transferencia">游낁 Transferencia</option>
                                        <option value="cheque">游닇 Cheque</option>
                                    </select>
                                </div>
                                
                                <button type="submit" class="btn-primary btn-block">
                                    <i class="fas fa-save"></i> Registrar Movimiento
                                </button>
                            </form>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header"><h3>Resumen del D칤a</h3></div>
                        <div class="card-body">
                            <div class="summary-stats-vertical">
                                <div class="stat-card stat-ingreso">
                                    <div class="stat-icon"><i class="fas fa-arrow-up"></i></div>
                                    <div class="stat-details">
                                        <span class="stat-label">Ingresos Extras</span>
                                        <span class="stat-value" id="totalIngresos">$0.00</span>
                                    </div>
                                </div>
                                
                                <div class="stat-card stat-egreso">
                                    <div class="stat-icon"><i class="fas fa-shopping-cart"></i></div>
                                    <div class="stat-details">
                                        <span class="stat-label">Gastos</span>
                                        <span class="stat-value" id="totalGastos">$0.00</span>
                                    </div>
                                </div>
                                
                                <div class="stat-card stat-deposito">
                                    <div class="stat-icon"><i class="fas fa-university"></i></div>
                                    <div class="stat-details">
                                        <span class="stat-label">Dep칩sitos</span>
                                        <span class="stat-value" id="totalDepositos">$0.00</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Movimientos de Hoy</h3>
                        <div class="card-actions">
                            <input type="text" id="searchMovimientos" placeholder="Buscar..." class="search-input">
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Hora</th>
                                        <th>Tipo</th>
                                        <th>Categor칤a</th>
                                        <th>Descripci칩n</th>
                                        <th>Monto</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="movimientosTableBody">
                                    <tr class="empty-row"><td colspan="6">No hay movimientos registrados</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CUADRE -->
            <div id="tab-cuadre" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-calculator"></i> Cuadre de Caja</h2>
                </div>
                
                <div class="content-grid">
                    <div class="card">
                        <div class="card-header"><h3>Datos del D칤a</h3></div>
                        <div class="card-body">
                            <div class="form-group">
                                <label>Fondo Inicial ($)</label>
                                <input type="number" id="fondoInicial" step="0.01" min="0" placeholder="0.00">
                                <small>Dinero en caja del d칤a anterior</small>
                            </div>
                            
                            <div class="form-group">
                                <label>Total de Ventas del D칤a ($)</label>
                                <input type="number" id="totalVentas" step="0.01" min="0" placeholder="0.00">
                                <small>Ingresa el total de ventas de tu sistema contable</small>
                            </div>
                            
                            <button id="guardarDatosBtn" class="btn-primary btn-block">
                                <i class="fas fa-save"></i> Guardar Datos
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header"><h3>Resumen</h3></div>
                        <div class="card-body">
                            <div class="cuadre-summary">
                                <div class="cuadre-item">
                                    <span>Fondo Inicial:</span>
                                    <span id="resumenFondo">$0.00</span>
                                </div>
                                <div class="cuadre-item">
                                    <span>Ventas del D칤a:</span>
                                    <span id="resumenVentas">$0.00</span>
                                </div>
                                <div class="cuadre-item">
                                    <span>Ingresos Extras:</span>
                                    <span id="resumenIngresos">$0.00</span>
                                </div>
                                <div class="cuadre-item">
                                    <span>Gastos:</span>
                                    <span id="resumenGastos" style="color: #ef4444;">-$0.00</span>
                                </div>
                                <div class="cuadre-item">
                                    <span>Dep칩sitos:</span>
                                    <span id="resumenDepositos" style="color: #ef4444;">-$0.00</span>
                                </div>
                                <div class="cuadre-divider"></div>
                                <div class="cuadre-item cuadre-total">
                                    <span>Saldo Esperado:</span>
                                    <span id="saldoEsperado">$0.00</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header"><h3>Conteo de Efectivo</h3></div>
                    <div class="card-body">
                        <div class="denominaciones-grid">
                            <div class="denominacion-group">
                                <h4>Billetes</h4>
                                <div class="denominacion-item" data-valor="100">
                                    <span class="denom-label">$100</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="50">
                                    <span class="denom-label">$50</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="20">
                                    <span class="denom-label">$20</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="10">
                                    <span class="denom-label">$10</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="5">
                                    <span class="denom-label">$5</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="1">
                                    <span class="denom-label">$1</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                            </div>
                            
                            <div class="denominacion-group">
                                <h4>Monedas</h4>
                                <div class="denominacion-item" data-valor="0.50">
                                    <span class="denom-label">$0.50</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="0.25">
                                    <span class="denom-label">$0.25</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="0.10">
                                    <span class="denom-label">$0.10</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="0.05">
                                    <span class="denom-label">$0.05</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                                <div class="denominacion-item" data-valor="0.01">
                                    <span class="denom-label">$0.01</span>
                                    <input type="number" class="denom-input" min="0" value="0">
                                    <span class="denom-total">$0.00</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="cuadre-resultado">
                            <div class="resultado-item">
                                <span>Total Contado:</span>
                                <span id="totalContado" class="resultado-valor">$0.00</span>
                            </div>
                            <div class="resultado-item resultado-diferencia">
                                <span>Diferencia:</span>
                                <span id="diferencia" class="resultado-valor">$0.00</span>
                            </div>
                        </div>
                        
                        <button id="cuadrarCajaBtn" class="btn-cuadrar btn-block">
                            <i class="fas fa-check-double"></i> CUADRAR CAJA
                        </button>
                    </div>
                </div>
            </div>

            <!-- REPORTES -->
            <div id="tab-reportes" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-file-alt"></i> Reportes</h2>
                </div>
                
                <div class="card">
                    <div class="card-header"><h3>Filtros</h3></div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Desde</label>
                                <input type="date" id="fechaDesde">
                            </div>
                            <div class="form-group">
                                <label>Hasta</label>
                                <input type="date" id="fechaHasta">
                            </div>
                            <div class="form-group">
                                <label>Tipo</label>
                                <select id="filtroTipo">
                                    <option value="">Todos</option>
                                    <option value="ingreso">Ingresos</option>
                                    <option value="gasto">Gastos</option>
                                    <option value="deposito">Dep칩sitos</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <button id="generarReporteBtn" class="btn-primary">
                                    <i class="fas fa-sync-alt"></i> Generar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header"><h3>Detalles</h3></div>
                    <div class="card-body">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Tipo</th>
                                        <th>Categor칤a</th>
                                        <th>Descripci칩n</th>
                                        <th>Monto</th>
                                    </tr>
                                </thead>
                                <tbody id="reporteTableBody">
                                    <tr class="empty-row"><td colspan="5">Genera un reporte</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- GR츼FICOS -->
            <div id="tab-graficos" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-chart-line"></i> Gr치ficos</h2>
                </div>
                
                <div class="content-grid">
                    <div class="card">
                        <div class="card-header"><h3>칔ltimos 7 D칤as</h3></div>
                        <div class="card-body">
                            <canvas id="chart7dias" height="250"></canvas>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header"><h3>Por Tipo</h3></div>
                        <div class="card-body">
                            <canvas id="chartTipos" height="250"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CONFIGURACI칍N -->
            <div id="tab-configuracion" class="tab-content">
                <div class="tab-header">
                    <h2><i class="fas fa-cog"></i> Configuraci칩n</h2>
                </div>
                
                <div class="content-grid">
                    <div class="card">
                        <div class="card-header"><h3>Categor칤as - Ingresos</h3></div>
                        <div class="card-body">
                            <div id="categoriasIngresoList" class="categorias-list"></div>
                            <div class="form-group">
                                <input type="text" id="nuevaCategoriaIngreso" placeholder="Nueva categor칤a...">
                                <button id="addCategoriaIngresoBtn" class="btn-primary">
                                    <i class="fas fa-plus"></i> Agregar
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header"><h3>Categor칤as - Gastos</h3></div>
                        <div class="card-body">
                            <div id="categoriasGastoList" class="categorias-list"></div>
                            <div class="form-group">
                                <input type="text" id="nuevaCategoriaGasto" placeholder="Nueva categor칤a...">
                                <button id="addCategoriaGastoBtn" class="btn-primary">
                                    <i class="fas fa-plus"></i> Agregar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header"><h3>Preferencias</h3></div>
                    <div class="card-body">
                        <div class="settings-group">
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label>Modo Oscuro</label>
                                    <small>Tema oscuro</small>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="darkModeSwitch">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <button id="resetDataBtn" class="btn-danger">
                            <i class="fas fa-trash-alt"></i> Limpiar Datos
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Toasts -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <h3 id="confirmTitle">Confirmar</h3>
            <p id="confirmMessage">쮼st치 seguro?</p>
            <div class="modal-actions">
                <button id="confirmCancelBtn" class="btn-secondary">Cancelar</button>
                <button id="confirmOkBtn" class="btn-primary">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Modal Cuadre Resultado -->
    <div id="cuadreModal" class="modal">
        <div class="modal-content modal-cuadre">
            <div id="cuadreResultado"></div>
            <button id="cuadreOkBtn" class="btn-primary btn-block">Cerrar</button>
        </div>
    </div>

    <script src="firebase-config.js"></script>
    <script src="app.js"></script>
</body>
</html>
